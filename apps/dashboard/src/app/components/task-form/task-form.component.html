<div class="fixed inset-0 z-50 flex items-center justify-center p-4">
  <div class="fixed inset-0 bg-black/40" (click)="onCancel()"></div>
  <div class="relative w-full max-w-lg" (click)="$event.stopPropagation()">
    <mat-card>
      <mat-card-header>
        <mat-card-title>{{ task ? 'Edit Task' : 'Create New Task' }}</mat-card-title>
        <mat-card-subtitle>{{ task ? 'Update task details' : 'Add a new task to your board' }}</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" class="space-y-6 task-form">
          <mat-form-field class="field">
            <mat-label>Title</mat-label>
            <input matInput type="text" formControlName="title" placeholder="Enter task title" required />
          </mat-form-field>

          <mat-form-field class="field">
            <mat-label>Description</mat-label>
            <textarea matInput formControlName="description" rows="3"
              placeholder="Add a description (optional)"></textarea>
          </mat-form-field>

          <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
            <mat-form-field class="field">
              <mat-label>Category</mat-label>
              <input matInput type="text" formControlName="category" placeholder="Work" />
            </mat-form-field>

            <mat-form-field class="field">
              <mat-label>Priority</mat-label>
              <mat-select formControlName="priority">
                <mat-option value="low">Low</mat-option>
                <mat-option value="medium">Medium</mat-option>
                <mat-option value="high">High</mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <mat-form-field class="field">
            <mat-label>Status</mat-label>
            <mat-select formControlName="status">
              <mat-option value="todo">To Do</mat-option>
              <mat-option value="in_progress">In Progress</mat-option>
              <mat-option value="done">Done</mat-option>
            </mat-select>
          </mat-form-field>

          <div *ngIf="errorMessage"
            class="rounded-md border border-destructive/30 bg-destructive/10 p-3 text-sm text-destructive">
            {{ errorMessage }}
          </div>

          <div class="flex justify-end gap-4 pt-4">
            <button mat-stroked-button type="button" (click)="onCancel()">Cancel</button>
            <button mat-raised-button color="primary" type="submit" [disabled]="taskForm.invalid || isSubmitting">
              {{ isSubmitting ? 'Saving...' : (task ? 'Update Task' : 'Create Task') }}
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>